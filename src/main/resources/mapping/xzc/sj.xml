<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.accp.dao.xzc.ISjDao">
<select id="queryAllUser" resultType="com.accp.pojo.User">
		SELECT *FROM USER u JOIN ShArea sh ON sh.areaID=u.country 
		<where>
				<if test="auditstatus!=0">
					auditstatus=#{auditstatus}
				</if>
				<if test="merchanttype!=0">
					AND merchanttype=#{merchanttype} 
				</if>
					<if test="username!=null">
					AND username=#{username} 
				</if>
		</where>
		ORDER BY merchantRegistrationTime DESC
	</select>
	
	<select id="queryUser" resultType="com.accp.vo.xzc.userVo">
			SELECT *,s.stName AS stname1,w.stName AS stname2 FROM `USER` u JOIN serviceType s ON u.firstServiceID=s.stid JOIN serviceType w ON u.secondServiceID=w.stid JOIN ShArea sh ON sh.areaID=u.country 
		<where>
				<if test="userid!=0">
					userid=#{userid}
				</if>
		</where>
	</select>
	<select id="queryAllAppraisalApply" resultType="com.accp.vo.xzc.appVo">
	SELECT *,(SELECT userName FROM `user` WHERE `user`.`userID`=Appraisalapply.`userID`) AS userName
		FROM Appraisalapply 
		<where>
				<if test="auditstatus!=0">
					auditstatus=#{auditstatus}
				</if>
		</where>
		ORDER BY submitTime DESC
	</select>
		<update id="updatash">
			UPDATE 	`Appraisalapply` SET auditStatus = 3 WHERE userid = #{userid}
		</update>
		<select id="queryAppraisalApply" resultType="com.accp.vo.xzc.appVo">
	SELECT *,(SELECT userName FROM `user` WHERE `user`.`userID`=Appraisalapply.`userID`) AS userName
		FROM Appraisalapply 
		<where>
				<if test="userid!=0">
					userid=#{userid}
				</if>
		</where>
		ORDER BY submitTime DESC
	</select>
</mapper>